<!DOCTYPE html>
<html> 
  <head> 
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <!--The viewport meta tag is used to improve the presentation and behavior of the samples 
      on iOS devices-->
    <meta name="viewport" content="initial-scale=1, maximum-scale=1,user-scalable=no">
    <title>Map with scalebar</title>

    <link rel="stylesheet" href="http://js.arcgis.com/3.10/js/dojo/dijit/themes/claro/claro.css"> 
    <link rel="stylesheet" href="http://js.arcgis.com/3.10/js/esri/css/esri.css">
    <style> 
      html, body { height: 100%; width: 100%; margin: 0; padding: 0; font-family: sans-serif;}
      #map{padding:0; overflow:hidden; width:100%}
      #titleBar{
      	font-size: x-large;
      }
      #gazetteer {
        display: block;
        position: absolute;
        z-index: 20;
        top: 5px;
        right: 5px;
		}
     #tcStopsAndOptions {
     		height: 35%;
     }
      #btnCalcRoute {
      	/*top: 5px;      	*/
      }
    </style> 

    <script src="http://js.arcgis.com/3.10/"></script>
    <script> 
      var map, gazetteer, dtBarriers;
      var lyrBarriers, lyrEndpoints;
      var txtOrigin, txtDestination;
 		var btnAddBarrier, btnClearBarriers;
 		var spsRouteStart, spsRouteEnd, gpcRouteStart, gpcRouteEnd;
 		
      require([
      	"dojo/dom",
      	"dojo/on",
      	"dijit/registry",
			"dojo/parser",
			"esri/map", 
			"esri/graphic",
			"esri/Color",
			"esri/layers/GraphicsLayer",
			"esri/symbols/SimpleLineSymbol",
			"esri/symbols/SimpleFillSymbol",
			"esri/symbols/PictureMarkerSymbol",
			"esri/dijit/Scalebar",
			"esri/dijit/Geocoder",
			"esri/toolbars/draw",
			"dijit/layout/BorderContainer", 
			"dijit/layout/ContentPane", 
			"dijit/layout/TabContainer",
			"dojox/layout/TableContainer",
			"dijit/form/TextBox",	
			"dijit/form/Button",
			"dijit/form/NumberSpinner",	
			"dojo/_base/lang",
			"dojo/domReady!"
      ], function(
      	dom,
      	on,
      	registry,
			parser,
			Map, 
			Graphic,
			Color,
			GraphicsLayer,
			SimpleLineSymbol,
			SimpleFillSymbol,
			PictureMarkerSymbol,
			Scalebar,
			Geocoder,
			Draw,
			BorderContainer,
			ContentPane,
			TabContainer,
			TableContainer,
			TextBox,
			Button,
			NumberSpinner,
			lang
      ) {
       	parser.parse();

			txtOrigin = registry.byId("origin");
			txtDestination = registry.byId("destination");
			
			spsRouteStart = new PictureMarkerSymbol("http://js.arcgis.com/3.10/js/esri/dijit/images/Directions/greenPoint.png", 32, 32);
			spsRouteEnd = new PictureMarkerSymbol("http://js.arcgis.com/3.10/js/esri/dijit/images/Directions/redPoint.png", 32, 32);
			var sfsBarrier = new SimpleFillSymbol(
				  SimpleFillSymbol.STYLE_BACKWARD_DIAGONAL
				, new SimpleLineSymbol(SimpleLineSymbol.STYLE_SOLID, new Color([255, 0, 0]), 2)
				, new Color([255, 255, 0, 1])
				);
			
			map = new Map("map"
            , { basemap: "topo",
               center: [-116.093, 34.218],
               zoom: 7
         });
         map.on("load", function() {
				dtBarriers = new Draw(map);
         	dtBarriers.on("draw-end", addBarrier);
         	lyrBarriers = new GraphicsLayer(); map.addLayer(lyrBarriers);
         	lyrEndpoints = new GraphicsLayer(); map.addLayer(lyrEndpoints);
         });

         gazetteer = new Geocoder({
         	map : map,
				autoComplete : true
         }, "gazetteer");
         gazetteer.startup();
         
         txtOrigin = new Geocoder({
         	autoComplete: true
         }, "origin");
         on(txtOrigin, "select, clear", verifyRoutingOptions);
         
         txtDestination = new Geocoder({
         	autoComplete: true
         }, "destination");
        	on(txtDestination, "select, clear", verifyRoutingOptions);
 
	      var scalebar = new Scalebar({
	        map : map,
	        // "dual" displays both miles and kilometers
	        // "english" is the default, which displays miles
	        // use "metric" for kilometers
	       scalebarUnit : "dual"
	      });
	       
	      btnAddBarrier = registry.byId("btnAddBarrier");
	      btnClearBarriers = registry.byId("btnClearBarriers");
	      on(btnAddBarrier, "click", drawBarrier);
	      on(btnClearBarriers, "click", clearBarriers);
			
			// EVENTS
			function verifyRoutingOptions(parm1) {
				var wasCleared = (parm1 == null);
				var bBothStopsEntered = (txtOrigin.results.length > 0 && txtDestination.results.length > 0);
				console.log(
					parm1 ? "Created a stop\nparm1: " + parm1 : "Cleared a stop");
				// Check to see if we've got two selected addresses; if so, enable the GO button
				if ()
				var btnRoute = dijit.byId("btnCalcRoute");
				btnRoute.setDisabled(wasCleared || !bBothStopsEntered);
			}
			
			function drawBarrier(evt) {
		      map.disableMapNavigation();
		      dtBarriers.activate(Draw.FREEHAND_POLYGON);
			}
			
			function addBarrier(evt) {
	          //deactivate the toolbar 
	          dtBarriers.deactivate(); 
	          map.enableMapNavigation();
	
	          lyrBarriers.add(new Graphic(evt.geometry, sfsBarrier));
			}
			
			function clearBarriers(evt) {
				lyrBarriers.clear();
			}
		});
		
    </script> 
  </head> 
  
  <body class="claro"> 
    <div data-dojo-type="dijit/layout/BorderContainer" 
         data-dojo-props="design:'headline', gutters:false, liveSplitters:true"
         style="width: 100%; height: 100%; margin: 0;"> 
    
		<div id="titleBar" data-dojo-type="dijit/layout/ContentPane" data-dojo-props="region:'top'">
	    		Network Analyst / Routing
		</div>
 		
 		<div id="gazetteer"></div>
		
		<div id="routing" data-dojo-type="dijit/layout/ContentPane" data-dojo-props="splitter:true, region:'left'"
			style="width: 25%; margin: 0;">

			<div data-dojo-type="dijit/form/Button" id="btnCalcRoute" type="button"
				disabled="disabled">Route Me</div>

			<div data-dojo-type="dijit/layout/TabContainer" doLayout="true" id="tcStopsAndOptions">
				
				<div data-dojo-type="dijit/layout/ContentPane" title="Stops" data-dojo-props="selected:true">
			      Start here...
 					<div id="origin"></div>
					<!-- <input type="text" value="" id="origin" 
					    data-dojo-type="dijit/form/TextBox"
					    data-dojo-props="trim:true, placeholder:'Your start location'"/> -->
					<br/>
					...and stop here:
			 		<div id="destination"></div>
					<!-- <input type="text" value="" id="destination" 
					    data-dojo-type="dijit/form/TextBox"
					    data-dojo-props="trim:true, placeholder:'Your end location'"/> -->
					
				</div>
			   <div data-dojo-type="dijit/layout/ContentPane" title="Options">
						Here are some routing options for you.<br/><br/>
						<div data-dojo-type="dojox.layout.TableContainer" data-dojo-props="cols:1" id="tc1">
							<div data-dojo-type="dijit/layout/ContentPane" title="Max Speed:">
								<div data-dojo-type="dijit/form/NumberSpinner" id="maxVehicleSpeed"
									style="width: 50px;"
									data-dojo-props="smallDelta:5, constraints:{min:10,max:60,places:0}, value: 35"></div>
								<label>mph</label>
							</div>
							<div data-dojo-type="dijit/layout/ContentPane" title="Avoid roads faster than:">
								<div data-dojo-type="dijit/form/NumberSpinner" id="maxVehicleSpeedLimit"
									style="width: 50px;"
									data-dojo-props="smallDelta:5, constraints:{min:10,max:85,places:0}, value: 45"></div>
								<label>mph</label>
							</div>
							<div data-dojo-type="dijit/layout/ContentPane" title="Where you're not allowed to travel:">
								<button data-dojo-type="dijit/form/Button" id="btnAddBarrier" type="button">Draw new barrier</button>
								<button data-dojo-type="dijit/form/Button" id="btnClearBarriers" type="button">Clear all barriers</button>
							</div>
						</div>
				</div>
			
			</div>
			
		</div>
		
      <div id="map" 
           data-dojo-type="dijit/layout/ContentPane" 
           data-dojo-props="splitter:true, region:'center'" 
           > 
      </div> 

    </div> 
  </body> 
</html>